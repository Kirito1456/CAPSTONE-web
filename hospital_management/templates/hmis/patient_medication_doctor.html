{%load static%}
<title>{% block title %}Patient Data{% endblock %}</title>

{% block styles%} 
<link rel="stylesheet" href="{% static 'css/patient_medication_styles.css' %}">
{% endblock styles%}

{% block content %}
<div class = "whole-screen">
    <div id = "side-menu" style="background-color: #334a7c;">
        <div id = "all-info">
            <div id = "user-info"> 
                <div id = "image">
                    <img src="{% static 'hannie.jpg' %}" id = "display-photo">
                </div>
                <div id = "information">
                    <div id = "name"> Jeonghan </div>
                </div>
            </div>
            <div id = "menu"> 
                <div id = "a1"><a href="">Dashboard</a></div>
                <div id = "a2"><a href="">Appointments</a></div>
                <div id = "a3"><a href="{% url 'patient_data_doctor_view' %}">Patients</a></div>
                <div id = "a4" style="font-weight: bold;"><a href="{% url 'patient_medication_doctor' %}">Medications</a></div>
                <div id = "a5"><a href="">Message</a></div>
                <div id = "a6"><a href="">Profile</a></div>
                <div id = "a7"><a href="">Settings</a></div>
            </div>
        </div>
    </div>
    <div id = "other-information">
        <div id = "title">
            <div id = "left">
                <div id = "view-medication" style="font-weight: bold;"><a href="{% url 'patient_medication_doctor' %}">View Medication Orders/Prescriptions</a></div>
                <div id = "create-medication"><a href="{% url 'outpatient_medication_order' %}">Create Medication Order/Prescription</a></div>
            </div>  
            <div id = "right">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search Patient Name">
                    <button id="searchButton">Search</button>
                </div>
            </div>  
        </div>

        <div class = "table">
            <table id = "user-information" style="border-bottom: 1px #85AA9B solid;">
                <tr id = "head">
                    <th id = "uname">Name</th>
                    <th id = "last-update">Last Updated</th>
                    <th id = "followup">Follow-Up In</th>
                    <th id = "disease">Disease</th>
                    <th id = "status">Status</th>
                    <th id = "room">Room</th>
                    <th id = "bed">Bed</th>
                    
                </tr>
                <!--add for loop - up to 7-->
                {% for patients_id, patients_data in patients.items %}
                <tr id = "patient-info">
                    <td>
                        <a href="{% url 'patient_medication_table' patients_data.fname patients_data.lname patients_data.gender patients_data.bday %}">
                            <div id="patient-name">
                                <div id="photo-icon"><img src="{% static 'hannie.jpg' %}" id="photo"></div>
                                <div id="user-name">{{ patients_data.fname }} {{ patients_data.lname }}</div>
                            </div>
                        </a>
                    </td>
                    {% for patientsdata_id, patientsdata_data in patientsdata.items %}
                        {% if patients_data.uid == patientsdata_data.patientid %}
                        <td>{{ patientsdata_data.lastVisited }}</td> 
                        <td>{{ patientsdata_data.followup }}</td>
                        <td>{{ patientsdata_data.disease }}</td>
                        
                        <td>{{ patientsdata_data.status }}</td>
                        <td>{{ patientsdata_data.room }}</td>
                        <td>{{ patientsdata_data.bed }}</td>
                        {% endif %}
                    {% endfor %}
                </tr>
                {% endfor %}
            </table>
        </div>
        <div class="pagination">
            <a href="#">&laquo;</a>
            <a href="#" class="active">1</a>
            <a href="#">&raquo;</a>
        </div>
    </div>
</div>

<script>
   document.addEventListener("DOMContentLoaded", function() {
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const table = document.querySelector('.table tbody');

    searchButton.addEventListener('click', function() {
        const searchText = searchInput.value.trim().toLowerCase();

        const rows = table.querySelectorAll('tr');
        rows.forEach(function(row, index) {
            if (index === 0) {
                return;
            }
            const columns = row.querySelectorAll('td');
            let found = false;
            if (searchText === '') {
                row.style.display = '';
                return;
            }
            columns.forEach(function(column) {
                if (column.textContent.trim().toLowerCase().includes(searchText)) {
                    found = true;
                }
            });
            row.style.display = found ? '' : 'none';
        });
    });
});


</script>
        
{% endblock %}